<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="Visualizing firstname distribution within the university of Ulm.">

		<title>uulm Vornamen-Statistik</title>
		<link rel="stylesheet" type="text/css" href="css/jquery.jqplot.min.css">
		<link rel="stylesheet" type="text/css" href="css/jquery-ui.css">
		<link rel="stylesheet" type="text/css" href="css/jquery.mobile-1.3.2.min.css">
		<link rel="stylesheet" type="text/css" href="css/github-btn.css">

		<!--[if lt IE 9]><script language="javascript" type="text/javascript" src="js/excanvas.min.js"></script><![endif]-->
		<script type="text/javascript" src="js/data.js"></script>
		<script type="text/javascript" src="js/jquery-1.9.1.min.js"></script>
		<script type="text/javascript" src="js/jquery-ui.js"></script>
		<script type="text/javascript" src="js/jquery.mobile-1.3.2.min.js"></script>

		<script type="text/javascript" src="js/jquery.jqplot.min.js"></script>
		<script type="text/javascript" src="js/jqplot.canvasTextRenderer.min.js"></script>
		<script type="text/javascript" src="js/jqplot.barRenderer.min.js"></script>
		<script type="text/javascript" src="js/jqplot.categoryAxisRenderer.min.js"></script>

		<script type="text/javascript" src="js/jqplot.pointLabels.min.js"></script>

		<style type="text/css">
			.ui-header .ui-title {
				margin-right: 10%;
				margin-left: 10%;
			}

			#aboutProject {
				border-radius: 8px;
				font-size: 0.8em;
				font-family: Arial, Helvetica, sans-serif;
				padding: 15px;
				color: #222;
				width: 480px;
			}
		</style>
	</head>
	<body>
		<div data-role="page" id="graph-page">
			<div data-role="header">
				<h1>Vornamen an der Uni Ulm (Oktober 2013)</h1>
			</div>

			<div data-role="popup" id="aboutProject" data-overlay-theme="a" data-theme="d" data-corners="false">
				<a href="#" data-rel="back" data-role="button" data-theme="a" data-icon="delete" data-iconpos="notext" class="ui-btn-right">Close</a>
				<h3>&Uuml;ber dieses Projekt</h3>
				<div style="float:right; margin-left: 15px;">
					<a href="http://ulmAPI.de/" tabindex="-1" title="Hochschulgruppe 'datalove' für offene Daten an der Uni Ulm">
						<img src="img/ulmapi.png" width="100" alt="ulmAPI.de" title="Hochschulgruppe für offene Daten an der Uni Ulm" />
					</a>
				</div>
				<p>
					Dominik hatte beim <a href="http://ulmApi.de">OpenCityCamp 2013</a> 
					spontan die Idee, die Vornamen der Studierenden der Universität Ulm 
					zu visualisieren. Wenige Stunden später enstand diese kleine Web-App.
				</p>
				<p>
					Leider haben wir es einige Monate nicht geschafft diese richtig zu
					ver&ouml;ffentlichen, so dass Michi sich Ende Oktober hingesetzt hat um
					das Projekt zu aktualisieren und etwas zu erweitern.
				</p>
				<p>
					Der Datensatz besteht &ndash; Stand Oktober 2013 &ndash; aus 13925
					Eintr&auml;gen. Die Daten stammen aus den Unix-Systemen des 
					Kommunikations- und Informationszentrums der Uni Ulm (kiz).
				</p>

				<p>
					<a href="http://ulmAPI.de/">http://www.ulmAPI.de</a>
				</p>

				<p>&nbsp;</p>

				<span id="github-btn" class="github-btn github-me github-btn-large">
					<a target="_blank" href="https://github.com/UlmAPI/uulm-firstname-statistic" id="gh-btn" class="gh-btn">
						<span class="gh-ico"></span>
						<span id="gh-text" class="gh-text">uulm-firstname-statistic auf GitHub</span>
					</a>
				</span>

				<p>&nbsp;</p>

				<p style="text-align:right;">
					Dominik Meißner<br>
					<a href="http://ech0.de">http://ech0.de</a>
				</p>

				<p style="text-align:right;">
					Michael M&uuml;ller<br>
					<a href="http://micha.elmueller.net">http://micha.elmueller.net</a>
				</p>

		</div>

			<div data-role="content" style="overflow:visible;">
					<div class="ui-widget" data-role="fieldcontain">
					<div data-role="rangeslider">
						<label for="range-1a">Dargestellter Bereich:</label>
						<input name="range-1a" id="range-1a" min="0" max="200" value="110" type="range">
						<input name="range-1b" id="range-1b" min="0" max="250" value="250" type="range">
					</div>
					</div>

					<div class="ui-widget" data-role="fieldcontain">
						<label for="searchField">Suche nach Name:</label>
						<input id="searchField" />
						<ul id="suggestions" data-role="listview" data-inset="true"></ul>

					</div>


					<div style="min-height:300px;margin-left:10%;" id="outerchart">
						<div style="min-height:300px;" id="chart"></div>
					</div>
			</div>
			<div data-role="footer" class="ui-bar-c" style="background:none;margin-top:10px;border:none;text-align:right;padding-right:1em;">
				<a data-role="button" href="#aboutProject" data-rel="popup" data-position-to="window" data-transition="fade">
					<img src="img/uulm.png" style="height:27px;" />
				</a>
				<a data-mini="true" data-role="button" href="#aboutProject" data-rel="popup" data-position-to="window" data-transition="fade">
					<img src="img/icon.png" alt="ulmapi" style="height:27px" title="Informationen zu diesem Projekt" />
				</a>
			</div>
		</div>
		<script type="text/javascript">
			var plot1;
			function recalcData() {
				if (plot1) {
					var min = $("#range-1a").val();
					var max = $("#range-1b").val();

					var arr = [];
					labels = [];

					for (var i = 0; i < data.length; i++) {
						if (data[i][1] >= min && data[i][1] <= max) {
							arr[arr.length] = [
								data[i][1]
								, data[i][0] + " (" + data[i][1] + ")"
							];
						}
					}

					plot1.replot({data:[arr]});
					var shift = $(".jqplot-yaxis").css("left").replace(/^\-/, "");
					$("#outerchart").css("margin-left", shift);
				}
			}

			$(document).on('pageshow', '#graph-page', function(){ 
				$(window).resize(function() {
					$("#chart").height($(window).height() - 290);
					if (plot1) {
						plot1.replot();
					}
				}).resize();

				$("#range-1a").change(recalcData);
				$("#range-1b").change(recalcData);

				plot1 = $.jqplot('chart', [[['Loading Data...', 0]]], {
					seriesDefaults: {
						 rendererOptions: { barDirection: 'horizontal',
						 fillToZero: true }
						, renderer: $.jqplot.BarRenderer
					},
					axes: {
						yaxis: {
							//autoscale: true,
							//renderer: $.jqplot.CanvasAxisTickRenderer
							//renderer: $.jqplot.CanvasAxisLabelRenderer
							renderer: $.jqplot.CategoryAxisRenderer
							 //, tickOptions: { formatString: '%#d%%' }
						}
					}
				});
				recalcData();

				if(window.location.hash !== "") {
					window.location.hash = "";
					window.location.reload();
				}

				/* build autocomplete stuff */
				var availableNames = [];

				/* traverese the array in reverse, 
				so that the first results in the 
				autocomplete field have most matches */
				for (var i = data.length-1; i >= 0; i--) {
					availableNames.push(data[i][0] + " (" + data[i][1] + ")");
				}

				$("#searchField").autocomplete({
					source: availableNames,
						target: $('#suggestions'),
						callback: function(e) {
							var $a = $(e.currentTarget);
							$('#searchField').val($a.text());
							$("#searchField").autocomplete('clear');
						},

						link: 'target.html?term=',
						minLength: 1

				});
			});
		</script>
	</body>
</html>
